language: ruby
rvm:
  - 2.2
env:
  - DB=postgresql
script:
  - bundle exec rake spec
before_script:
  - bundle exec rake db:create RAILS_ENV=test
  - bundle exec rake db:migrate
  - bundle exec rake db:test:prepare
deploy:
  provider: heroku
  app: swim-beta
  run:
    - "bundle"
    - "rake db:migrate"
  strategy: git
  api_key: ENV['TRAVIS_TOKEN']
